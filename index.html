
<!DOCTYPE html>
<html>
    <head>
        <title>Bank CRUD</title>
    </head>
    <body>
        <h1>Bank Management</h1>
        <form id="BankForm">
         <input type ="hidden" id="employeeID">
        <div>
            <label for="employeeName"> Enter Employee Name</label>
            <input type="text" id="employeeName" required>
        </div>   
        <div>
            <label for="=empEmail">Enter Employee Email</label>
            <input type="text" id="empEmail" required>
        </div>
        <div>
            <label for="empPhone">Enter Employee Phone</label>
            <input type="text" id="empPhone" required>
        </div>
        <div>
            <label for="empAddress">Enter Employee Address</label>
            <input type="text" id="empAddress" required>
            <div>
                <label for="empSalary">Enter Employee Salary</label>
                <input type="text" id="empSalary" required>
            </div>
          <button type="submit" id="btnSubmit"> add Employee</button>
          <button type="reset" id="btnReset">Reset</button>
        </form>

        <h2> Employee List</h2>
        <table border="1>"
            <thead>
                <tr>
                    <th>Employee ID</th>
                    <th>Employee Name</th>
                    <th>Employee Email</th>
                    <th>Employee Phone</th>
                    <th>Employee Address</th>
                    <th>Employee Salary</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody id="employeeTableId"></tbody>
        </table>
     <script>
          const API_URL="http://localhost:3000/api/employees"; 
        
          const form = document.getElementById("BankForm");
           
            form.addEventListener("submit", async (event) => {
                event.preventDefault();
                const id = document.getElementById("employeeID").value;
                const employeeData = {
                    name: document.getElementById("employeeName").value,
                    email: document.getElementById("empEmail").value,
                    phone: document.getElementById("empPhone").value,
                    address: document.getElementById("empAddress").value,
                    salary: document.getElementById("empSalary").value,
                };
                if (id) {
                    await updateEmployee(id, employeeData);
                } else {
                    await createEmployee(employeeData);
                }

                foem.rest();
                document.getElementById("employeeID").value = "";
                fetchEmployees();
          });
              async funcation featchEmployees(){

                try {
                    let response;
                    if (employeeID) {
                        response = await fetch(`${API_URL}/${employeeID}`, {
                            method: "PUT",
                            headers: {
                                "Content-Type": "application/json"
                            },
                            body: JSON.stringify(employeeData)
                        });
                    } else {
                        response = await fetch(API_URL, {
                            method: "POST",
                            headers: {
                                "Content-Type": "application/json"
                            },
                            body: JSON.stringify(employeeData)
                        });
                    }
    
                    if (!response.ok) {
                        throw new Error(`Network response was not ok :${response.status}`);
                    }
    
                    await fetchEmployees();
                    form.reset();
                } catch (error) {
                    console.error("Error saving employee:", error);
                    alert('Failed to save employee:' + error.message);
                }
         
         
         async function fetchEmployees(){
        try{
          const response =await featch(API_URL)
            if(!response.ok){
                throw new Error(`Network response was not ok :${responce.ststus}`);
            }
            const employees = await response.json();
            const employeeTable = document.getElementById("employeeTableId");
            employeeTable.innerHTML = ""; 

            employees.forEach(employee => {
                const row = document.createElement("tr");
                row.innerHTML = `
                    <td>${employee.id ||'NA'}</td>
                    <td>${employee.name}</td>
                    <td>${employee.email ||'NA'}</td>
                    <td>${employee.phone ||'NA'}</td>
                    <td>${employee.address || 'NA'}</td>
                    <td>${employee.salary}</td>
                    <td>
                        <button onclick="editEmployee()">Edit</button>
                        <button onclick="deleteEmployee()">Delete</button>
                    </td>
                `;
                employeeTable.appendChild(row);
            });

        }catch(error){
            console.error("Error fetching employees:", error);
            consol('Failed to fetch employees:'+ error.message);
        }
 }

   async funcation updateEmployee(employeeID, employeeData) {
     try {
        const response = await fetch(`${API_URL}/${employeeID}`, {
            method: "PUT",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify(employeeData)
        });

        if (!response.ok) {
            throw new Error(`Network response was not ok :${response.status}`);
        }

        await fetchEmployees();
     } catch (error);
       }
    }

    async function deleteEmployee(employeeID) {
        try {
            if (confirm("Are you sure you want to delete this employee?")) {
                const response = await fetch(`${API_URL}/${employeeID}`, {
                    method: "DELETE"
            });

            if (!response.ok) 
                throw new Error(`Failed to delete employee:${response.status}`);
            }
        } catch (error) {
           console.error(error);
        }
    }
     async function editEmployee(employeeID) {
        try {
            const response = await fetch(`${API_URL}/${employeeID}`);
            if (!response.ok) 
                throw new Error(`Failed to fetch employee:${response.status}`);
            
            const employee = await response.json();

            document.getElementById("employeeID").value = employee.id;
            document.getElementById("employeeName").value = employee.name;
            document.getElementById("empEmail").value = employee.email;
            document.getElementById("empPhone").value = employee.phone;
            document.getElementById("empAddress").value = employee.address;
            document.getElementById("empSalary").value = employee.salary;
        } catch (error) {
            console.error(error);
        }
    } 

         // Initial fetch of employees
             fetchEmployees();
         </script>
     </body>
</html>
